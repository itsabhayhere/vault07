<div class="min-h-screen text-slate-200 flex flex-col items-center py-1 px-4 space-y-10">

  <!-- Blog Header & Content -->
  <div class="w-full max-w-5xl rounded-2xl p-6 md:p-10 shadow-lg hover:shadow-slate-800/40 transition-all duration-300">
    
    <!-- Header -->
    <div class="flex items-center justify-between mb-6">
      <h1 class="text-3xl md:text-4xl font-bold text-cyan-400">
        <%= post.title %>
      </h1>
    </div>

    <!-- Image -->
    <% if (imageUrl) { %>
    <div class="flex justify-center mb-8">
      <img
        src="<%= imageUrl %>"
        alt="<%= post.title %>"
        class="rounded-lg shadow-md max-h-[300px] object-contain"
        loading="lazy"
      />
    </div>
    <% } %>

    <!-- Content -->
    <div class="prose prose-invert max-w-none text-slate-300 leading-relaxed space-y-6">
      <%- post.content %>
    </div>

  </div>

  <!-- Download Box -->
  <% if (pdfUrl || zipUrl) { %>
  <div class="w-full max-w-5xl bg-gradient-to-r from-cyan-600/40 to-blue-600/40 border border-cyan-700/30 backdrop-blur-md rounded-2xl p-6 md:p-10 shadow-lg text-center space-y-4 hover:shadow-cyan-700/30 transition-all duration-300">
    
    <h2 class="text-2xl md:text-3xl font-semibold text-white">ğŸ“¥ Download Resources</h2>
    <p class="text-slate-200 text-sm md:text-base max-w-2xl mx-auto">
      Access the files attached to this post. Click below to go to the download page.
    </p>

    <% if (user) { %>
      <!-- User is logged in - Show download status -->
      <% 
        const status = downloadStatus || { count: 0, remaining: 5, limitReached: false };
      %>
      <% if (status.limitReached) { %>
        <div class="bg-red-900/30 border border-red-500/50 rounded-lg p-4 max-w-md mx-auto">
          <p class="text-red-300 font-semibold">âš ï¸ Daily Download Limit Reached</p>
          <p class="text-red-200 text-sm mt-2">
            You've reached your daily limit of 5 downloads. Please try again tomorrow.
          </p>
        </div>
      <% } else { %>
        <div class="bg-slate-900/60 border border-cyan-500/30 rounded-lg p-4 max-w-md mx-auto mb-4">
          <p class="text-slate-200 text-sm">
            ğŸ“Š Downloads today: <span class="text-cyan-400 font-semibold"><%= status.count %></span> / 5
          </p>
          <p class="text-slate-300 text-xs mt-1">
            Remaining: <span class="text-green-400"><%= status.remaining %></span>
          </p>
        </div>

        <!-- Available Files -->
        <div class="flex flex-col md:flex-row items-center justify-center gap-4 mt-6">
          <% if (pdfUrl) { %>
            <a 
              href="/api/download/<%= post._id %>/pdf"
              class="px-6 py-3 bg-red-600 hover:bg-red-500 text-white rounded-md transition flex items-center gap-2 min-w-[200px] justify-center">
              ğŸ“„ Download PDF
            </a>
          <% } %>
          
          <% if (zipUrl) { %>
            <a 
              href="/download/<%= post._id %>/zip"
              class="px-6 py-3 bg-purple-600 hover:bg-purple-500 text-white rounded-md transition flex items-center gap-2 min-w-[200px] justify-center">
              ğŸ“¦ Download ZIP
            </a>
          <% } %>
        </div>
      <% } %>
    <% } else { %>
      <!-- User is not logged in - Show login prompt -->
      <div class="text-center space-y-4">
        <p class="text-yellow-300 text-sm">
          ğŸ”’ You must be logged in to download resources
        </p>
        <a 
          href="/login?redirect=<%= encodeURIComponent('/blog/' + post.slug) %>" 
          class="inline-block px-6 py-3 bg-cyan-500 hover:bg-cyan-400 text-white rounded-md transition">
          ğŸ”‘ Login to Download
        </a>
        <p class="text-slate-300 text-xs">
          Don't have an account? <a href="/register?redirect=<%= encodeURIComponent('/blog/' + post.slug) %>" class="text-cyan-300 hover:text-cyan-200 underline">Register here</a>
        </p>
      </div>
    <% } %>

    <p class="text-xs text-slate-400 mt-6">
      *Note: Download links expire after 1 hour for security. Daily limit: 5 downloads per user.
    </p>
  </div>
  <% } %>

  <!-- Back to Blogs -->
  <div class="max-w-5xl w-full text-center">
    <a href="/blog" class="text-cyan-400 hover:text-cyan-300 transition font-medium">
      â† Back to all blogs
    </a>
  </div>

</div>